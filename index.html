<html>
<head>
	<style>
	*{padding: 0; margin:0;}
	canvas{ background: #eee; display: block; margin: 0 auto;}
	</style>
</head>
<body>
<canvas id= "myCanvas" width="800" height="600"></canvas>
<script src="keyboard.js"></script>
<script src="characterLibrary.js"></script>
<script src="windows.js"></script>
<script type="text/javascript">
let canvas = document.getElementById("myCanvas");
let ctx = canvas.getContext("2d");
canvas.addEventListener("mousemove", getPosition, false);
canvas.addEventListener("mouseup", getMouseUp, false);
canvas.addEventListener("mousedown", getMouseDown, false);
document.addEventListener("keydown",keyDownHandler, false);
document.addEventListener("keyup",keyUpHandler,false);
ctx.canvas.width  = window.innerWidth;
ctx.canvas.height = window.innerHeight;
//defining any needed variables
let fps = 100;
const wW = window.innerWidth;
const wH = window.innerHeight;
let word = [];
let mouseIsDown = false;
let doubleClick = false;
let mouseX = -1;
let mouseY = -1;
let oldMouseX = -1;
let oldMouseY = -1;

//mouse handler functions
function getPosition(e)
{
	mouseX = e.x - canvas.offsetLeft;
	mouseY = e.y - canvas.offsetTop;
}

function getMouseDown(e)
{
	mouseIsDown = true;
	let oldMouseX = mouseX;
	let oldMouseY = mouseY;
}

function getMouseUp(e)
{
	mouseIsDown = false;
}

//allows for text boxes to work properly
function wrapText(ctx, text, x, y, maxWidth, lineHeight)
{
	if(text != null)
	{
		var words = text.split(' ');
		var line = '';

		for(var n = 0; n < words.length; n++)
		{
			var testLine = line + words[n] + ' ';
			var metrics = ctx.measureText(testLine);
			var testWidth = metrics.width;
			if (testWidth > maxWidth && n > 0)
			{
				ctx.fillText(line, x, y);
				line = words[n] + ' ';
				y += lineHeight;
			}
			else
			{
				line = testLine;
			}
		}
		ctx.fillText(line, x, y);
	}
}

//creates drop down boxes when called
function dropDownBox(cR,cG,cB,rectX,rectY,rectL,rectH,listAmount,text,sub)
{
	makeBoxSame = true;
	ctx.fillStyle = "rgb(" + cR + "," + cG + "," + cB + ")";
	ctx.fillRect(rectX,rectY,rectL,rectH);
	let listPart = 0;
	let tabSize = (rectH / listAmount);
	for(let i = 0; i < listAmount; i++)
	{
		ctx.textAlign = "center";
		ctx.textBaseline = "middle";
		ctx.fillStyle = "rgb(0,0,0)";
		if(sub == false)
		{
			ctx.fillText(text[i].name,rectX+(rectL/2),rectY+listPart+(tabSize/2));
			if(mouseX >= rectX && mouseX <= rectX + rectL && mouseY >= rectY + listPart && mouseY <= rectY + listPart + tabSize)
			{
				ctx.fillStyle = "rgb(" + (cR-20) + "," + (cG-20) + "," + (cB-20) + ")";
				ctx.fillRect(rectX,rectY+listPart,rectL,tabSize);
				ctx.fillStyle = "rgb(0,0,0)";
				ctx.fillText(text[i].name,rectX+(rectL/2),rectY+listPart+(tabSize/2));
				if(mouseIsDown)
				{
					mouseIsDown = false;
					makeListSame = text[i].name;
					makeBoxSame = false;
				}
			}
		}
		if(sub == true)
		{
			ctx.fillText(text[i],rectX+(rectL/2),rectY+listPart+(tabSize/2));
			if(mouseX >= rectX && mouseX <= rectX + rectL && mouseY >= rectY + listPart && mouseY <= rectY + listPart + tabSize)
			{
				ctx.fillStyle = "rgb(" + (cR-20) + "," + (cG-20) + "," + (cB-20) + ")";
				ctx.fillRect(rectX,rectY+listPart,rectL,tabSize);
				ctx.fillStyle = "rgb(0,0,0)";
				ctx.fillText(text[i],rectX+(rectL/2),rectY+listPart+(tabSize/2));
				if(mouseIsDown)
				{
					mouseIsDown = false;
					makeListSame = text[i];
					makeBoxSame = false;
				}
			}
		}
		ctx.textBaseline = "alphabetic"
		listPart += tabSize;
	}
	if(mouseX <= rectX || mouseX >= rectX + rectL || mouseY <= rectY || mouseY >= rectY + rectH)
	{
		makeListSame = "";
		if(mouseIsDown)
		{
			mouseIsDown = false;
			makeBoxSame = false;
		}
	}
}

//draws all other functions
function draw()
{
	setTimeout(function()
	{
		requestAnimationFrame(draw);
		ctx.clearRect(0,0,wW,wH);
		///all code goes here
		mouseTimer++;
		drawIcons();
		drawWindows();
		openWindows();
		useLocalStorage();
		if(mouseIsDown)
		{
			oldMouseX = mouseX;
			oldMouseY = mouseY;
		}
	}, 1000/fps);
}
draw();


//this is just a reminder for me on how to open PDFs
//window.open("pdf url here", '_blank');

</script>
</body>
</html>